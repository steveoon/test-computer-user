---
description: 
globs: 
alwaysApply: true
---
# ğŸ¯ ç»ˆæ Cursor Rules æ¶æ„å¸ˆ

## [AI ä»£ç ç”Ÿæˆä¸“å®¶]
ä½ æ˜¯ä¸€ä½èåˆäº†è½¯ä»¶æ¶æ„å¸ˆã€TypeScript å¤§å¸ˆã€React ä¸“å®¶ã€æ€§èƒ½ä¼˜åŒ–å¸ˆäºä¸€ä½“çš„ä»£ç ç”Ÿæˆå¼•æ“è®¾è®¡è€…ã€‚ä½ æ·±è°™ç°ä»£å‰ç«¯å¼€å‘çš„æœ€ä½³å®è·µï¼Œèƒ½å¤Ÿåˆ›é€ å‡ºè®© AI ç”Ÿæˆå®Œç¾ä»£ç çš„è§„åˆ™ä½“ç³»ã€‚

## ğŸ§¬ æ ¸å¿ƒè®¾è®¡DNA
- **æ¶æ„æ€ç»´**ï¼šæ·±åº¦ç†è§£ Next.js 15 + React 19 ç”Ÿæ€ç³»ç»Ÿ
- **ç±»å‹å®‰å…¨**ï¼šTypeScript ç±»å‹ç³»ç»Ÿçš„æè‡´è¿ç”¨
- **æ€§èƒ½å¯¼å‘**ï¼šæ¯ä¸€è¡Œä»£ç éƒ½è€ƒè™‘æ€§èƒ½å½±å“
- **å¯ç»´æŠ¤æ€§**ï¼šä»£ç å¦‚è¯—ä¸€èˆ¬ä¼˜é›…ä¸”è‡ªè§£é‡Š

## ğŸš€ `.cursor.rules` æè‡´ç‰ˆæœ¬

```mdx
# ğŸ¯ AI-SDK Computer Use Project - Cursor Rules v2.0

## ğŸ—ï¸ é¡¹ç›®æ¶æ„æ¦‚è§ˆ

**æŠ€æœ¯æ ˆæ ¸å¿ƒï¼š**
- Next.js 15.2.1 (App Router + Server Actions)
- React 19 (Concurrent Features + Compiler)
- TypeScript 5 (Strict Mode + Advanced Types)
- Tailwind CSS 4 (Modern CSS + Utility-First Design)
- AI SDK 4.3+ (Universal Tool Integration)
- Zod 3.24+ (Runtime Validation)
- E2B Desktop (Sandbox Environment)

**æ¶æ„åŸåˆ™ï¼š**
- ğŸ¯ **æ€§èƒ½ä¼˜å…ˆ**ï¼šæ¯ä¸ªå†³ç­–éƒ½è€ƒè™‘ Core Web Vitals
- ğŸ”’ **ç±»å‹å®‰å…¨**ï¼š100% TypeScriptï¼Œé›¶ `any` å®¹å¿åº¦
- ğŸ§© **ç»„ä»¶åŒ–**ï¼šé«˜å†…èšã€ä½è€¦åˆçš„ç»„ä»¶è®¾è®¡
- âš¡ **ç°ä»£è¯­æ³•**ï¼šES2024+ ç‰¹æ€§ä¼˜å…ˆä½¿ç”¨
- ğŸ›¡ï¸ **é”™è¯¯è¾¹ç•Œ**ï¼šä¼˜é›…çš„é”™è¯¯å¤„ç†å’Œæ¢å¤
- ğŸ“Š **å¯è§‚æµ‹æ€§**ï¼šå†…ç½®ç›‘æ§å’Œè°ƒè¯•æ”¯æŒ

---

## ğŸ“ æ–‡ä»¶ç»“æ„æ ‡å‡†

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ app/                    # App Router (Next.js 15)
â”‚   â”œâ”€â”€ api/               # API Routes + Server Actions
â”‚   â”œâ”€â”€ globals.css        # Global Styles
â”‚   â”œâ”€â”€ layout.tsx         # Root Layout
â”‚   â””â”€â”€ page.tsx           # Pages
â”œâ”€â”€ components/            # Reusable Components
â”‚   â”œâ”€â”€ ui/               # Base UI Components
â”‚   â””â”€â”€ [feature]/        # Feature-specific Components
â”œâ”€â”€ lib/                  # Utility Libraries
â”‚   â”œâ”€â”€ [domain]/         # Domain-specific Utilities
â”‚   â”œâ”€â”€ utils.ts          # General Utilities
â”‚   â””â”€â”€ types.ts          # Global Type Definitions
â””â”€â”€ public/               # Static Assets
```

---

## ğŸ¨ ä»£ç é£æ ¼æŒ‡å—

### TypeScript æœ€ä½³å®è·µ

**âœ… æ¨èå†™æ³•ï¼š**
```typescript
// ä¸¥æ ¼ç±»å‹å®šä¹‰ï¼Œä½¿ç”¨readonlyæå‡ä¸å¯å˜æ€§
interface APIResponse<T> {
  readonly data: T;
  readonly status: 'success' | 'error';
  readonly message?: string;
  readonly timestamp: Date;
}

// æ³›å‹çº¦æŸä¸æ¡ä»¶ç±»å‹
type ExtractArrayType<T> = T extends readonly (infer U)[] ? U : never;

// æ¨¡æ¿å­—é¢é‡ç±»å‹ï¼Œæå‡ç±»å‹å®‰å…¨
type EventType = `on${Capitalize<string>}`;

// é«˜çº§æ˜ å°„ç±»å‹
type Optional<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>;

// å“ç‰Œç±»å‹é˜²æ­¢ç±»å‹æ··æ·†
type UserId = string & { readonly __brand: 'UserId' };
type Email = string & { readonly __brand: 'Email' };
```

**âŒ é¿å…å†™æ³•ï¼š**
```typescript
// ç¦æ­¢ä½¿ç”¨ any
const data: any = {};

// ç¦æ­¢ç±»å‹æ–­è¨€æ»¥ç”¨
const element = document.getElementById('id') as HTMLElement;

// ç¦æ­¢ç©ºæ¥å£
interface EmptyInterface {}
```

### React 19 ç°ä»£æ¨¡å¼

**âœ… ç»„ä»¶è®¾è®¡æ ‡å‡†ï¼š**
```typescript
// æ³›å‹ç»„ä»¶è®¾è®¡æ¨¡å¼
interface ComponentProps<T extends ElementType = 'div'> {
  readonly as?: T;
  readonly variant?: 'primary' | 'secondary';
  readonly children: ReactNode;
}

const GenericComponent = <T extends ElementType = 'div'>({
  as,
  variant = 'primary',
  className,
  children,
  ...props
}: ComponentProps<T> & ComponentPropsWithoutRef<T>) => {
  const Component = as ?? 'div';
  
  return (
    <Component
      className={cn(getVariantStyles(variant), className)}
      {...props}
    >
      {children}
    </Component>
  );
};

// è‡ªå®šä¹‰Hookç±»å‹å®‰å…¨æ¨¡å¼
function useAsyncState<T, E = Error>(
  initialValue: T | null = null
): {
  readonly data: T | null;
  readonly error: E | null;
  readonly loading: boolean;
  readonly execute: (operation: () => Promise<T>) => Promise<void>;
} {
  const [state, setState] = useState<{
    data: T | null;
    error: E | null;
    loading: boolean;
  }>({
    data: initialValue,
    error: null,
    loading: false,
  });

  const execute = useCallback(async (operation: () => Promise<T>) => {
    setState(prev => ({ ...prev, loading: true, error: null }));
    
    try {
      const result = await operation();
      setState({ data: result, error: null, loading: false });
    } catch (error) {
      setState({ data: null, error: error as E, loading: false });
    }
  }, []);

  return { ...state, execute };
}
```

### Next.js 15 App Router æ¨¡å¼

**âœ… Server Actionsï¼š**
```typescript
// ç±»å‹å®‰å…¨çš„Server Actionæ¨¡å¼
interface ActionResult<T> {
  readonly success: boolean;
  readonly data?: T;
  readonly error?: string;
  readonly details?: unknown;
}

async function typedServerAction<T>(
  schema: z.ZodSchema,
  formData: FormData
): Promise<ActionResult<T>> {
  try {
    // è¾“å…¥éªŒè¯
    const validatedData = schema.parse(
      Object.fromEntries(formData.entries())
    );

    // ä¸šåŠ¡é€»è¾‘å¤„ç†
    const result = await processBusinessLogic<T>(validatedData);
    
    // ç¼“å­˜å¤±æ•ˆ
    revalidatePath('/relevant-path');
    
    return { success: true, data: result };
  } catch (error) {
    if (error instanceof z.ZodError) {
      return { 
        success: false, 
        error: 'Validation failed',
        details: error.errors 
      };
    }
    return { success: false, error: 'Internal server error' };
  }
}
```

**âœ… API Routesï¼š**
```typescript
// ç»Ÿä¸€çš„APIé”™è¯¯å¤„ç†æ¨¡å¼
interface APIResponse<T> {
  readonly data?: T;
  readonly status: 'success' | 'error';
  readonly message?: string;
  readonly timestamp: Date;
}

export async function POST(
  request: Request
): Promise<NextResponse<APIResponse<unknown>>> {
  try {
    const body = await request.json();
    const validatedData = inputSchema.parse(body);
    
    const result = await serviceLayer.process(validatedData);
    
    return NextResponse.json({
      data: result,
      status: 'success',
      timestamp: new Date(),
    });
  } catch (error) {
    return handleAPIError(error);
  }
}
```

---

## ğŸ¯ AI SDK é›†æˆæ ‡å‡†

**âœ… é€šç”¨Toolå®šä¹‰æ¨¡å¼ï¼š**
```typescript
// å¯æ‰©å±•çš„å·¥å…·å‚æ•°æ¨¡å¼
const createUniversalTool = (toolName: string, config: ToolConfig) =>
  tool({
    description: `${toolName} - ${config.description}`,
    parameters: z.object({
      action: z.enum(config.actions).describe("æ“ä½œç±»å‹"),
      parameters: z.record(z.unknown()).optional().describe("åŠ¨æ€å‚æ•°"),
      options: z.object({
        timeout: z.number().optional(),
        retries: z.number().optional(),
      }).optional(),
    }),
    execute: async ({ action, parameters, options }) => {
      // é€šç”¨é”™è¯¯å¤„ç†åŒ…è£…
      return await withErrorHandling(
        () => config.handlers[action](mdc:parameters, options),
        { 
          operation: `${toolName}.${action}`,
          timeout: options?.timeout,
          retries: options?.retries 
        }
      );
    },
  });

// ç»“æœæ ‡å‡†åŒ–æ¥å£
interface ToolResult {
  readonly type: 'text' | 'image' | 'json';
  readonly data: string | object;
  readonly metadata?: Record<string, unknown>;
}
```

---

## ğŸ¨ Tailwind CSS æ ·å¼æ ‡å‡†

**âœ… ç°ä»£CSSæ¨¡å¼ï¼š**
```typescript
// æ¡ä»¶æ ·å¼ç»„åˆå·¥å…·
const createStyleVariants = (baseStyles: string) => ({
  base: baseStyles,
  variants: {
    size: {
      sm: "h-8 px-3 text-sm",
      md: "h-10 px-4 text-base", 
      lg: "h-12 px-6 text-lg",
    },
    variant: {
      primary: "bg-primary text-primary-foreground hover:bg-primary/90",
      secondary: "bg-secondary text-secondary-foreground hover:bg-secondary/80",
    },
  },
  compoundVariants: [
    {
      size: "sm",
      variant: "primary",
      class: "font-medium",
    },
  ],
});

// å“åº”å¼è®¾è®¡æ¨¡å¼
const ResponsiveComponent = () => (
  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4">
    <div className="aspect-square bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg">
      {/* å†…å®¹ */}
    </div>
  </div>
);
```

---

## ğŸ›¡ï¸ é”™è¯¯å¤„ç†æ ‡å‡†

**âœ… ç°ä»£é”™è¯¯è¾¹ç•Œæ¨¡å¼ï¼š**
```typescript
// å‡½æ•°ç»„ä»¶é”™è¯¯è¾¹ç•Œï¼ˆReact 19ï¼‰
function ErrorBoundary({ 
  children, 
  fallback: Fallback,
  onError 
}: {
  children: ReactNode;
  fallback?: ComponentType<{ error: Error; reset: () => void }>;
  onError?: (error: Error, errorInfo: ErrorInfo) => void;
}) {
  return (
    <ErrorBoundaryImpl
      fallback={Fallback}
      onError={onError}
    >
      {children}
    </ErrorBoundaryImpl>
  );
}

// å¼‚æ­¥æ“ä½œé”™è¯¯å¤„ç†
const withErrorHandling = async <T>(
  operation: () => Promise<T>,
  context: { operation: string; timeout?: number; retries?: number }
): Promise<T> => {
  const { operation: opName, timeout = 5000, retries = 1 } = context;
  
  for (let attempt = 1; attempt <= retries; attempt++) {
    try {
      const timeoutPromise = new Promise<never>((_, reject) =>
        setTimeout(() => reject(new Error(`${opName} timeout`)), timeout)
      );
      
      return await Promise.race([operation(), timeoutPromise]);
    } catch (error) {
      if (attempt === retries) {
        console.error(`${opName} failed after ${retries} attempts:`, error);
        throw error;
      }
      console.warn(`${opName} attempt ${attempt} failed, retrying...`);
      await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
    }
  }
  
  throw new Error(`${opName} exhausted all retries`);
};
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–æŒ‡å—

**âœ… ä»£ç åˆ†å‰²ç­–ç•¥ï¼š**
```typescript
// æ™ºèƒ½ç»„ä»¶æ‡’åŠ è½½
const LazyComponent = lazy(() => 
  import('./Component').then(module => ({
    default: module.Component
  }))
);

// Suspenseè¾¹ç•Œä¼˜åŒ–
function OptimizedApp() {
  return (
    <Suspense fallback={<ComponentSkeleton />}>
      <ErrorBoundary fallback={ErrorFallback}>
        <LazyComponent />
      </ErrorBoundary>
    </Suspense>
  );
}
```

**âœ… ç¼“å­˜ç­–ç•¥ï¼š**
```typescript
// React 19 ç¼“å­˜æ¨¡å¼
const cachedDataFetcher = cache(async (id: string) => {
  const data = await fetchFromAPI(id);
  return data;
});

// è®°å¿†åŒ–è®¡ç®—
const expensiveCalculation = useMemo(() => 
  computeExpensiveValue(dependencies), 
  [dependencies]
);
```

---

## ğŸ”’ ç±»å‹å®‰å…¨ä¿éšœ

**âœ… è¿è¡Œæ—¶éªŒè¯æ¨¡å¼ï¼š**
```typescript
// Zodé›†æˆæ¨¡å¼
const createTypedSchema = <T>() => ({
  schema: z.object({}) as z.ZodType<T>,
  validate: (data: unknown): data is T => {
    return schema.safeParse(data).success;
  },
  parse: (data: unknown): T => {
    return schema.parse(data);
  },
  safeParse: (data: unknown) => {
    return schema.safeParse(data);
  },
});

// ç±»å‹å®ˆå«æ¨¡å¼
function createTypeGuard<T>(
  schema: z.ZodSchema<T>
): (value: unknown) => value is T {
  return (value: unknown): value is T => {
    return schema.safeParse(value).success;
  };
}
```

---

## ğŸ“Š ä»£ç è´¨é‡æ ‡å‡†

### å¿…é¡»éµå¾ªçš„è§„åˆ™ï¼š

1. **é›¶å®¹å¿ `any` ç±»å‹** - ä½¿ç”¨ `unknown` ç„¶åç±»å‹æ”¶çª„
2. **ä¸¥æ ¼ null æ£€æŸ¥** - æ‰€æœ‰å¯èƒ½ä¸º null çš„å€¼å¿…é¡»æ˜¾å¼å¤„ç†
3. **åªè¯»ä¼˜å…ˆ** - ä¼˜å…ˆä½¿ç”¨ `readonly` å’Œ `const assertions`
4. **å‡½æ•°å¼ç¼–ç¨‹** - ä¼˜å…ˆä½¿ç”¨çº¯å‡½æ•°å’Œä¸å¯å˜æ•°æ®
5. **æ˜ç¡®çš„è¿”å›ç±»å‹** - æ‰€æœ‰å‡½æ•°å¿…é¡»æ˜¾å¼å£°æ˜è¿”å›ç±»å‹
6. **ç»„ä»¶ Props æ¥å£** - æ‰€æœ‰ç»„ä»¶ props å¿…é¡»æœ‰æ˜ç¡®æ¥å£å®šä¹‰
7. **é”™è¯¯å¤„ç†** - æ‰€æœ‰å¼‚æ­¥æ“ä½œå¿…é¡»æœ‰é”™è¯¯å¤„ç†
8. **æ€§èƒ½è€ƒé‡** - é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“å’Œè®¡ç®—

### ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹ï¼š

- [ ] æ˜¯å¦ä½¿ç”¨äº†æœ€æ–°çš„ React 19 ç‰¹æ€§ï¼Ÿ
- [ ] æ˜¯å¦éµå¾ªäº† Next.js 15 æœ€ä½³å®è·µï¼Ÿ
- [ ] ç±»å‹å®šä¹‰æ˜¯å¦è¶³å¤Ÿä¸¥æ ¼å’Œå‡†ç¡®ï¼Ÿ
- [ ] æ˜¯å¦æœ‰æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ï¼Ÿ
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„ï¼Ÿ
- [ ] ä»£ç æ˜¯å¦å…·æœ‰è‰¯å¥½çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Ÿ
- [ ] æ˜¯å¦ç¬¦åˆé¡¹ç›®çš„æ¶æ„åŸåˆ™ï¼Ÿ

---

## ğŸ¯ ç‰¹æ®ŠæŒ‡ä»¤

å½“ç”Ÿæˆä»£ç æ—¶ï¼Œè¯·ï¼š

1. **ä¼˜å…ˆä½¿ç”¨é¡¹ç›®ä¸­å·²å­˜åœ¨çš„ç»„ä»¶å’Œå·¥å…·**
2. **ä¿æŒä¸ç°æœ‰ä»£ç é£æ ¼çš„ä¸€è‡´æ€§**
3. **æ·»åŠ å¿…è¦çš„ JSDoc æ³¨é‡Šç”¨äºå¤æ‚é€»è¾‘**
4. **è€ƒè™‘å›½é™…åŒ–å’Œæ— éšœç¢æ€§**
5. **ç¡®ä¿ä»£ç å¯æµ‹è¯•æ€§**
6. **éµå¾ª SOLID åŸåˆ™**
7. **ä½¿ç”¨è¯­ä¹‰åŒ–çš„å‘½å**
8. **ä¿æŒå‡½æ•°å’Œç»„ä»¶çš„å•ä¸€èŒè´£**

---

*è®°ä½ï¼šæ¯ä¸€è¡Œä»£ç éƒ½åº”è¯¥æ˜¯æœ‰æ„å›¾çš„ã€å¯ç»´æŠ¤çš„ã€é«˜æ€§èƒ½çš„ã€‚æˆ‘ä»¬è¿½æ±‚çš„ä¸ä»…ä»…æ˜¯èƒ½å·¥ä½œçš„ä»£ç ï¼Œè€Œæ˜¯ä¼˜é›…çš„ã€æœªæ¥å¯æŒç»­çš„è§£å†³æ–¹æ¡ˆã€‚*